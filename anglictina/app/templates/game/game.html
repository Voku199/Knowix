<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Knowix Game</title>
    <script src="{{ url_for('static', filename='game/js/phaser.min.js') }}"></script>
    <script src="{{ url_for('static', filename='game/js/main.js') }}"></script>
</head>
<body>
<h1>Knowix Game</h1>
<div id="game-container"></div>
<script>
    (function () {
        if (window.__themeToggleInit) return;
        window.__themeToggleInit = true;
        const btn = document.getElementById('theme-toggle');
        if (!btn) return;
        const CSRF_TOKEN = '{{ csrf_token() }}';
        btn.addEventListener('click', () => {
            fetch('/set_theme', {
                method: 'POST',
                headers: {'Content-Type': 'application/json', 'X-CSRFToken': CSRF_TOKEN},
                body: JSON.stringify({
                    theme: document.body.classList.contains('dark-mode') ? 'light' : 'dark',
                    csrf_token: CSRF_TOKEN
                })
            }).then(r => {
                if (r.ok) {
                    document.body.classList.toggle('dark-mode');
                    sessionStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
                }
            });
        });
    })();
</script>
</body>
</html>
