{% extends "base.html" %}

{% block content %}
<style>
    .alpha-badge {
        font-size: 1.2em;
        font-weight: bold;
        color: red;
        text-transform: uppercase;
        letter-spacing: 2px;
        margin-top: 10px;
        display: inline-block;
        padding: 5px 15px;
        border-radius: 20px;
        background: rgba(255, 0, 0, 0.1);
    }

    .footer-signature {
        font-size: 1em;
        font-weight: bold;
        color: #666;
        margin-top: 10px;
    }

    .logo-name {
        font-size: 4rem;
        color: #2c3e50;
        text-transform: lowercase;
        margin-bottom: 15px;
        letter-spacing: -2px;
    }

    .profile-container {
        position: relative;
    }

    .profile-pic {
        border-radius: 50%;
    }

    .profile-menu {
        position: absolute;
        top: 70px;
        right: 0;
        background-color: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        opacity: 0;
        visibility: hidden;
        transform: translateY(10px);
        transition: all 0.3s ease-in-out;
    }

    .profile-container:hover .profile-menu {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
    }

    /* XP Progress bar v headeru */
    .xp-header-bar {
        margin-top: 0.5em;
        margin-bottom: 0.5em;
        width: 220px;
        max-width: 90vw;
    }

    .xp-header-bar-labels {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 1em;
        margin-bottom: 0.2em;
    }

    .xp-level-badge {
        background: #4CAF50;
        color: #fff;
        border-radius: 8px;
        padding: 2px 10px;
        font-weight: 600;
        font-size: 0.95em;
        margin-right: 0.5em;
    }

    .xp-value {
        color: #333;
        font-size: 0.95em;
    }

    body.dark-mode .xp-level-badge {
        background: #2e7d32;
    }

    body.dark-mode .xp-value {
        color: #eee;
    }

    .xp-header-bar-progress-bg {
        background: #e0e0e0;
        border-radius: 8px;
        height: 12px;
        width: 100%;
        overflow: hidden;
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.04);
    }

    .xp-header-bar-progress {
        height: 100%;
        background: linear-gradient(90deg, #4CAF50 60%, #43a047 100%);
        border-radius: 8px 0 0 8px;
        transition: width 0.4s;
    }

    body.dark-mode .xp-header-bar-progress-bg {
        background: #333;
    }

    body.dark-mode .xp-header-bar-progress {
        background: linear-gradient(90deg, #2e7d32 60%, #1b5e20 100%);
    }

    /* Fixn√≠ panel denn√≠ch √∫kol≈Ø vpravo uprost≈ôed (desktop) */
    .daily-quests-fixed {
        position: fixed;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
        width: min(360px, 85vw);
        z-index: 1000;
    }

    /* Na mobilu se m√° zobrazit dole (p≈ôirozen√Ω tok dokumentu) */
    @media (max-width: 991.98px) {
        .daily-quests-fixed {
            position: static;
            transform: none;
            width: auto;
            margin: 12px 16px 24px 16px; /* trocha vzduchu naho≈ôe i dole */
        }

        /* Ujisti se, ≈æe blok je vizu√°lnƒõ oddƒõlen√Ω a na konci */
        .daily-quests-fixed {
            order: 99;
        }

        main {
            display: flex;
            flex-direction: column;
        }
    }

    /* Voliteln√Ω decentn√≠ styl pro text pod bublinou */
    .plain-note {
        color: #555;
        margin: 6px 2px;
    }

    .pwa-popout {
        position: fixed;
        z-index: 10000;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        max-width: 560px;
        width: calc(100% - 32px);
        background: rgba(255, 255, 255, 0.98);
        color: #111;
        border-radius: 16px;
        box-shadow: 0 12px 34px rgba(0, 0, 0, 0.35);
        padding: 18px;
        display: none;
    }

    .pwa-popout h3 {
        margin: 0 0 6px;
        font-size: 18px;
        font-weight: 700;
    }

    .pwa-popout p {
        margin: 8px 0;
        line-height: 1.5;
    }

    .pwa-popout .steps {
        background: #f3f4f6;
        border-radius: 12px;
        padding: 12px;
    }

    .pwa-popout .close-btn {
        background: none;
        border: none;
        color: #555;
        font-weight: 600;
        padding: 8px 12px;
        border-radius: 10px;
        cursor: pointer;
    }

    .pwa-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(6px);
        z-index: 9999;
        display: none;
    }
</style>

<main>
    <section class="intro">
        <h1 class="logo-name">knowix</h1>
        <!--        <span class="alpha-badge">ALPHA VERZE</span>-->
        <h2 class="motto">Dƒõl√°no pro lidi</h2>
    </section>

    <section class="info">

        <div class="bubble support-bubble" onclick="location.href='/anglictina'">
            <img src="{{ url_for('static', filename='icons/eng.png') }}" alt="angliƒçtina">
            <div class="bubble-text">
                <h3>Angliƒçtina</h3>
                <p>Z√°bavn√© cviƒçen√≠ na t√©ma Angliƒçtina</p>
            </div>
        </div>
        <!-- ‚ÄûPWA aplikace‚Äú -->
        <div class="bubble support-bubble" onclick="openPwaHelp()">
            <img src="{{ url_for('static', filename='pic/logo1.webp') }}" alt="Knowix Logo">
            <div class="bubble-text">
                <h3>PWA aplikace</h3>
                <p>Knowix jde nainstalovat jako aplikace. Klikni a uvid√≠≈° jak.</p>
            </div>
        </div>
        <div class="bubble support-bubble" onclick="location.href='/proc_jit_s_nama'">
            <img src="{{ url_for('static', filename='pic/why.png') }}" alt="Podpora">
            <div class="bubble-text">
                <h3>Proƒç cviƒçit na Knowixu?</h3>
                <p>Klikni na to, a dozv√≠te se proƒç bys mƒõl n√°s doporuƒçit ostatn√≠m.</p>
            </div>
        </div>
        <!-- Kontakty bublina samostatnƒõ, text zvl√°≈°≈• pod n√≠ -->
        <div class="bubble support-bubble" onclick="location.href='/kontakty'">
            <img src="{{ url_for('static', filename='pic/contac.png') }}" alt="Podpora">
            <div class="bubble-text">
                <h3>Kontakty</h3>
                <p>Klikni jestli≈æe chce≈° zjistit <strong>Discord, tiktok a atd...</strong></p>
            </div>
        </div>
        <div class="bubble support-bubble" onclick="window.open('https://ko-fi.com/voku199', '_blank')">
            <img src="{{ url_for('static', filename='pic/support.webp') }}" alt="Podpora">
            <div class="bubble-text">
                <h3>Podpora</h3>
                <p>Chce≈° mƒõ finanƒçnƒõ podpo≈ôit? Klikni na to üòä</p>
                <p>Dobrovoln√Ω p≈ô√≠spƒõvek!</p>
            </div>
        </div>
    </section>

    <div class="daily-quests-fixed">
        {% include 'daily_quest.html' %}
    </div>
</main>

<div id="pwaOverlay" class="pwa-overlay" onclick="closePwaHelp()"></div>
<div id="pwaPopout" class="pwa-popout" role="dialog" aria-modal="true" aria-labelledby="pwaHelpTitle">
    <div style="display:flex; align-items:center; margin-bottom: 10px;">
        <div style="width:44px; height:44px; border-radius:50%; background: linear-gradient(90deg, #2d7ff9, #6aa9ff); display:flex; align-items:center; justify-content:center; color:#fff; font-weight:700; font-size:18px; margin-right:10px;">
            ‚¨áÔ∏è
        </div>
        <div>
            <h3 id="pwaHelpTitle">Instalace PWA aplikace</h3>
            <p style="margin:2px 0 0; font-size:13px; color:#555;">Knowix si m≈Ø≈æe≈° nainstalovat jako aplikaci.</p>
        </div>
    </div>
    <div class="steps">
        <p><strong>Chrome / Edge (Windows, Android):</strong></p>
        <p>1) Klikni na ikonu ‚ÄûInstalovat‚Äú vpravo naho≈ôe nebo otev≈ôi menu ‚ãÆ a zvol ‚ÄûInstalovat aplikaci‚Äú.</p>
        <p>2) Potvrƒè instalaci. Aplikace se objev√≠ v nab√≠dce Start / na plo≈°e.</p>
        <hr style="border:none; border-top:1px solid #e5e7eb; margin:10px 0;">
        <p><strong>Safari (iOS):</strong></p>
        <p>1) Otev≈ôi menu ‚ÄûSd√≠let‚Äú (ikonka se ≈°ipkou nahoru).</p>
        <p>2) Zvol ‚ÄûP≈ôidat na plochu‚Äú.</p>
        <p>3) Potvrƒè. Ikona se p≈ôid√° na plochu jako aplikace.</p>
    </div>
    <div style="display:flex; justify-content:flex-end; margin-top:12px;">
        <button class="close-btn" onclick="closePwaHelp()">Zav≈ô√≠t</button>
        <button style="background: linear-gradient(90deg, #3b82f6, #8b5cf6); color:#fff; font-weight:600; padding:8px 14px; border:none; border-radius:10px; cursor:pointer; margin-left:8px;"
                onclick="triggerPwaInstall()">Zkusit instalaci
        </button>
    </div>
</div>

<script>
    function openPwaHelp() {
        document.getElementById('pwaOverlay').style.display = 'block';
        document.getElementById('pwaPopout').style.display = 'block';
    }

    function closePwaHelp() {
        document.getElementById('pwaOverlay').style.display = 'none';
        document.getElementById('pwaPopout').style.display = 'none';
    }

    function triggerPwaInstall() {
        const btn = document.getElementById('install-app');
        if (btn) {
            btn.click();
        } else {
            alert('Instalace nen√≠ dostupn√° v tomto prohl√≠≈æeƒçi. Postupuj dle n√°vodu.');
        }
    }
</script>
<script>document.body.classList.add('onboarding-active');   </script>
<script>const CSRF_TOKEN = "{{ csrf_token() }}";</script>
<script>
    document.addEventListener('click', (e) => {
        const profileMenu = document.getElementById('profileMenu');
        const trigger = document.getElementById('profileMenuTrigger');
        if (profileMenu && trigger && !trigger.contains(e.target) && !profileMenu.contains(e.target)) {
            profileMenu.style.opacity = '0';
            profileMenu.style.visibility = 'hidden';
            profileMenu.style.transform = 'translateY(10px)';
        }
    });
</script>
<script>document.body.classList.remove('onboarding-active');</script>
<div class="plain-note">Dƒõkujeme za <strong>th3cooki1 desing discordu! (ig : @th3cooki1 i discord)</strong></div>

{% endblock %}
