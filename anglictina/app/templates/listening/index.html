{% extends "base.html" %}
{% block content %}
<main class="listening-container">
    <h1>Listening Lessons</h1>

    {% for level, lessons_in_level in lessons.items() %}
    <section>
        <h2>Level {{ level }}</h2>
        <ul>
            {% for lesson in lessons_in_level %}
            <li>
                <a href="{{ url_for('listening_bp.lesson', level=level, lesson_id=lesson.id) }}">
                    {{ lesson.title }}
                </a>
            </li>
            {% endfor %}
        </ul>
    </section>
    {% endfor %}
</main>


<script>
    // theme-toggle.js
    document.getElementById('theme-toggle').addEventListener('click', () => {
        fetch('/set_theme', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                theme: document.body.classList.contains('dark-mode') ? 'light' : 'dark'
            })
        }).then(() => {
            document.body.classList.toggle('dark-mode');
            session.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
        });
    });

    // Detekce kliknutÃ­ mimo menu
    document.addEventListener('click', (e) => {
        const profileMenu = document.getElementById('profileMenu');
        const trigger = document.getElementById('profileMenuTrigger');

        if (!trigger.contains(e.target) && !profileMenu.contains(e.target)) {
            profileMenu.style.opacity = '0';
            profileMenu.style.visibility = 'hidden';
            profileMenu.style.transform = 'translateY(10px)';
        }
    });
</script>
{% endblock %}